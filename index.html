<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR.js Image Tracking</title>
 <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
        <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
        <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
  <!-- AR.js Scene -->
  <a-scene
    vr-mode-ui="enabled: false;"
            loading-screen="enabled: false;"
            renderer="logarithmicDepthBuffer: true;"
            arjs="trackingMethod: best; sourceType: webcam;source: environment;debugUIEnabled: false;"
            id="scene"
            embedded
            gesture-detector
  >
<a-assets>
                <a-asset-item
                    id="animated-asset"
                    src="businesscard1.glb"
                ></a-asset-item>
            </a-assets>
    
    <!-- Image Marker with Smoothing -->
    <a-marker
      preset="custom"
      type="pattern"
      url="pattern-qr1.patt"
      raycaster="objects: .clickable"
                emitevents="true"
                cursor="fuse: false; rayOrigin: mouse;"
      smooth="true"
      smoothCount="10"
      smoothTolerance="0.01"
      smoothThreshold="5"
    >
      <!-- AR Content -->
      <a-entity
        gltf-model="#animated-asset"
        scale="0.5 0.5 0.5"
        animation-mixer="loop: repeat"
        class="clickable"
        position="0 0 0"
        gesture-handler
      ></a-entity>
      <a-text
        value="Hello AR!"
        color="blue"
        position="0 0.5 0"
      ></a-text>
    </a-marker>

    <!-- Camera with Custom Movement -->
    <a-entity 
  camera 
  look-controls="pointerLockEnabled: true; reverseMouseDrag: false;"
></a-entity>
    <script>
    // Switch Camera
    function switchCamera() {
      const scene = document.querySelector('a-scene');
      const arSystem = scene.systems['arjs'];
      const currentSource = arSystem.data.source;

      // Toggle between front and rear camera
      const newSource = currentSource === 'environment' ? 'user' : 'environment';

      // Reinitialize AR.js with the new source
      arSystem.el.setAttribute('arjs', `source: ${newSource}; sourceType: webcam; debugUIEnabled: false;`);
    }

    // Zoom Camera
    function zoomCamera(zoomIn) {
      const camera = document.querySelector('a-entity[camera]').getObject3D('camera');
      if (zoomIn) {
        camera.zoom = Math.min(camera.zoom + 0.1, 2); // Maximum zoom level
      } else {
        camera.zoom = Math.max(camera.zoom - 0.1, 1); // Minimum zoom level
      }
      camera.updateProjectionMatrix(); // Update the camera's projection matrix
    }
  </script>
  </a-scene>
</body>
</html>
